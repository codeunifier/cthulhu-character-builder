<div class="container" *ngIf="character">
  <h1 class="section-title">Choose Occupation</h1>
  
  <mat-card>
    <mat-card-content>
      <h2>Selected Occupation</h2>
      
      <div *ngIf="selectedOccupation" class="selected-occupation">
        <h3>{{ selectedOccupation.name }}</h3>
        <p><strong>Credit Rating:</strong> {{ getCreditRatingString(selectedOccupation) }}</p>
        <p><strong>Skills:</strong> {{ getSkillsString(selectedOccupation) }}</p>
        <p><strong>Skill Points Formula:</strong> {{ selectedOccupation.skillPointsFormula }}</p>
        <p><strong>Available Skill Points:</strong> {{ character.remainingSkillPoints }}</p>
      </div>
      
      <div *ngIf="!selectedOccupation" class="no-occupation">
        <p>No occupation selected. Please choose one from the list below.</p>
      </div>
    </mat-card-content>
  </mat-card>
  
  <mat-card>
    <mat-card-content>
      <div class="search-container">
        <mat-form-field class="search-field">
          <mat-label>Search Occupations</mat-label>
          <input matInput [(ngModel)]="searchTerm" (keyup)="filterOccupations()" placeholder="Filter by name or skills">
          <button *ngIf="searchTerm" matSuffix mat-icon-button aria-label="Clear" (click)="searchTerm=''; filterOccupations()">
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>
      </div>
      
      <div class="table-container">
        <table mat-table [dataSource]="filteredOccupations" class="occupation-table">
          <!-- Name Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Occupation</th>
            <td mat-cell *matCellDef="let occupation">{{ occupation.name }}</td>
          </ng-container>
          
          <!-- Credit Rating Column -->
          <ng-container matColumnDef="creditRating">
            <th mat-header-cell *matHeaderCellDef>Credit Rating</th>
            <td mat-cell *matCellDef="let occupation">{{ getCreditRatingString(occupation) }}</td>
          </ng-container>
          
          <!-- Skills Column -->
          <ng-container matColumnDef="skills">
            <th mat-header-cell *matHeaderCellDef>Skills</th>
            <td mat-cell *matCellDef="let occupation" class="skills-cell">{{ getSkillsString(occupation) }}</td>
          </ng-container>
          
          <!-- Skill Points Column -->
          <ng-container matColumnDef="skillPoints">
            <th mat-header-cell *matHeaderCellDef>Points</th>
            <td mat-cell *matCellDef="let occupation">
              {{ occupation.skillPointsFormula }}
              <span class="points-value">({{ getSkillPointsValue(occupation) }})</span>
            </td>
          </ng-container>
          
          <!-- Action Column -->
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef>Action</th>
            <td mat-cell *matCellDef="let occupation">
              <button mat-raised-button color="primary" (click)="selectOccupation(occupation)">
                Select
              </button>
            </td>
          </ng-container>
          
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"
              [class.selected-row]="selectedOccupation && selectedOccupation.name === row.name"></tr>
        </table>
      </div>
    </mat-card-content>
  </mat-card>
  
  <div class="actions-container">
    <button mat-raised-button color="primary" (click)="saveAndContinue()" [disabled]="!selectedOccupation">
      Save and Continue
    </button>
  </div>
</div>