import{a as q,b as K}from"./chunk-6TE33IS6.js";import"./chunk-7RWCIHFI.js";import{g as $,h as W,j as U}from"./chunk-BJM7LMXK.js";import{r as G}from"./chunk-LT2PDRQ3.js";import{a as Y,b as Z,c as X,d as J,e as tt,f as it,g as et,h as at,i as nt,j as ot,k as ct}from"./chunk-PZNYEYD6.js";import"./chunk-S5WO7LK6.js";import{a as F,b as P,d as B}from"./chunk-T4H2DEYZ.js";import{Aa as d,Ac as H,Ba as p,Bc as z,Cc as N,Da as b,Dc as j,E as I,Ec as Q,F as E,Fa as v,Ga as h,K as g,L as f,Ob as R,Qa as o,Ra as u,Sa as x,_ as c,ca as C,ga as k,ha as M,la as r,nc as S,pa as l,pb as A,sb as D,ta as w,xa as a,xc as O,ya as n,yb as T,yc as V,za as y,zc as L}from"./chunk-7I6J3OSZ.js";var pt=new E("mat-chips-default-options",{providedIn:"root",factory:()=>({separatorKeyCodes:[13]})});var rt=(()=>{class t{static \u0275fac=function(s){return new(s||t)};static \u0275mod=M({type:t});static \u0275inj=I({providers:[W,{provide:pt,useValue:{separatorKeyCodes:[13]}}],imports:[S,V,S]})}return t})();function ht(t,i){if(t&1&&(a(0,"div",24)(1,"h3"),o(2,"Available Occupational Skills:"),n(),a(3,"p"),o(4),n(),a(5,"p",25)(6,"em"),o(7,"Note: Some skills allow choices. For simplicity, this builder pre-selects the primary skills, but you should consider the full list above when customizing your character."),n()()()),t&2){let e=h(3);c(4),u(e.character.occupation.skillsDescription)}}function mt(t,i){if(t&1&&(a(0,"h2"),o(1),n(),a(2,"p")(3,"strong"),o(4,"Remaining Skill Points:"),n(),a(5,"span",21),o(6),n()(),a(7,"div",22)(8,"p"),o(9),n(),a(10,"ul")(11,"li"),o(12,"Points can be allocated to occupational skills or personal interest skills."),n(),a(13,"li"),o(14,"You must spend at least some points on skills to continue."),n(),a(15,"li"),o(16,"The Credit Rating skill must stay within the range for your occupation."),n(),a(17,"li"),o(18,'You can add skills to your personal interests section from the "Other Skills" list.'),n()()(),r(19,ht,8,1,"div",23)),t&2){let e=h(2);c(),x("Occupation: ",e.character.occupation.name,""),c(5),x(" ",e.character.remainingSkillPoints,""),c(3),x("Allocate your skill points to improve your skills. You have ",e.character.remainingSkillPoints," points to distribute."),c(10),l("ngIf",e.character.occupation==null?null:e.character.occupation.skillsDescription)}}function ut(t,i){t&1&&(a(0,"h2"),o(1,"No Occupation Selected"),n(),a(2,"div",26),o(3,'Please return to the "Occupation" page to select your occupation before selecting skills.'),n())}function _t(t,i){t&1&&(a(0,"th",27),o(1,"Skill"),n())}function vt(t,i){if(t&1&&(a(0,"td",28),o(1),n()),t&2){let e=i.$implicit;c(),u(e.name)}}function gt(t,i){t&1&&(a(0,"th",27),o(1,"Base"),n())}function ft(t,i){if(t&1&&(a(0,"td",28),o(1),n()),t&2){let e=i.$implicit;c(),u(e.baseValue)}}function yt(t,i){t&1&&(a(0,"th",27),o(1,"Improvement"),n())}function bt(t,i){if(t&1&&(a(0,"td",28),o(1),n()),t&2){let e=i.$implicit;c(),u(e.improvementPoints)}}function Ct(t,i){t&1&&(a(0,"th",27),o(1,"Total"),n())}function xt(t,i){if(t&1&&(a(0,"td",29),o(1),n()),t&2){let e=i.$implicit;c(),u(e.total)}}function kt(t,i){t&1&&(a(0,"th",27),o(1,"Add/Remove Points"),n())}function wt(t,i){if(t&1){let e=b();a(0,"td",28)(1,"div",30)(2,"button",31),v("click",function(){let m=g(e).$implicit,_=h(2);return f(_.addPoints(m))}),a(3,"mat-icon"),o(4,"add"),n()(),a(5,"button",32),v("click",function(){let m=g(e).$implicit,_=h(2);return f(_.removePoints(m))}),a(6,"mat-icon"),o(7,"remove"),n()()()()}if(t&2){let e=i.$implicit,s=h(2);c(2),l("disabled",s.character.remainingSkillPoints<=0),c(3),l("disabled",e.improvementPoints<=0)}}function St(t,i){t&1&&y(0,"tr",33)}function It(t,i){t&1&&y(0,"tr",34)}function Et(t,i){t&1&&(a(0,"div",35)(1,"p"),o(2,"No personal skills selected yet. Add skills from the list below."),n()())}function Mt(t,i){t&1&&(a(0,"th",27),o(1,"Skill"),n())}function At(t,i){if(t&1&&(a(0,"td",28),o(1),n()),t&2){let e=i.$implicit;c(),u(e.name)}}function Dt(t,i){t&1&&(a(0,"th",27),o(1,"Base"),n())}function Tt(t,i){if(t&1&&(a(0,"td",28),o(1),n()),t&2){let e=i.$implicit;c(),u(e.baseValue)}}function Rt(t,i){t&1&&(a(0,"th",27),o(1,"Improvement"),n())}function Ft(t,i){if(t&1&&(a(0,"td",28),o(1),n()),t&2){let e=i.$implicit;c(),u(e.improvementPoints)}}function Pt(t,i){t&1&&(a(0,"th",27),o(1,"Total"),n())}function Bt(t,i){if(t&1&&(a(0,"td",29),o(1),n()),t&2){let e=i.$implicit;c(),u(e.total)}}function Ot(t,i){t&1&&(a(0,"th",27),o(1,"Add/Remove Points"),n())}function Vt(t,i){if(t&1){let e=b();a(0,"td",28)(1,"div",30)(2,"button",31),v("click",function(){let m=g(e).$implicit,_=h(3);return f(_.addPoints(m))}),a(3,"mat-icon"),o(4,"add"),n()(),a(5,"button",32),v("click",function(){let m=g(e).$implicit,_=h(3);return f(_.removePoints(m))}),a(6,"mat-icon"),o(7,"remove"),n()()()()}if(t&2){let e=i.$implicit,s=h(3);c(2),l("disabled",s.character.remainingSkillPoints<=0),c(3),l("disabled",e.improvementPoints<=0)}}function Lt(t,i){t&1&&(a(0,"th",27),o(1,"Remove"),n())}function Ht(t,i){if(t&1){let e=b();a(0,"td",28)(1,"button",37),v("click",function(){let m=g(e).$implicit,_=h(3);return f(_.removeFromPersonalInterests(m))}),a(2,"mat-icon"),o(3,"remove_circle"),n()()()}if(t&2){let e=i.$implicit;c(),l("disabled",e.improvementPoints>0)}}function zt(t,i){t&1&&y(0,"tr",33)}function Nt(t,i){t&1&&y(0,"tr",34)}function jt(t,i){if(t&1&&(a(0,"div",3)(1,"table",4),d(2,5),r(3,Mt,2,0,"th",6)(4,At,2,1,"td",7),p(),d(5,8),r(6,Dt,2,0,"th",6)(7,Tt,2,1,"td",7),p(),d(8,9),r(9,Rt,2,0,"th",6)(10,Ft,2,1,"td",7),p(),d(11,10),r(12,Pt,2,0,"th",6)(13,Bt,2,1,"td",11),p(),d(14,12),r(15,Ot,2,0,"th",6)(16,Vt,8,2,"td",7),p(),d(17,36),r(18,Lt,2,0,"th",6)(19,Ht,4,1,"td",7),p(),r(20,zt,1,0,"tr",13)(21,Nt,1,0,"tr",14),n()()),t&2){let e=h(2);c(),l("dataSource",e.selectedSkills),c(19),l("matHeaderRowDef",e.selectedDisplayedColumns),c(),l("matRowDefColumns",e.selectedDisplayedColumns)}}function Qt(t,i){t&1&&(a(0,"th",27),o(1,"Skill"),n())}function Gt(t,i){if(t&1&&(a(0,"td",28),o(1),n()),t&2){let e=i.$implicit;c(),u(e.name)}}function qt(t,i){t&1&&(a(0,"th",27),o(1,"Base"),n())}function Kt(t,i){if(t&1&&(a(0,"td",28),o(1),n()),t&2){let e=i.$implicit;c(),u(e.baseValue)}}function $t(t,i){t&1&&(a(0,"th",27),o(1,"Total"),n())}function Wt(t,i){if(t&1&&(a(0,"td",29),o(1),n()),t&2){let e=i.$implicit;c(),u(e.total)}}function Ut(t,i){t&1&&(a(0,"th",27),o(1,"Add"),n())}function Yt(t,i){if(t&1){let e=b();a(0,"td",28)(1,"button",38),v("click",function(){let m=g(e).$implicit,_=h(2);return f(_.addToPersonalInterests(m))}),a(2,"mat-icon"),o(3,"add_circle"),n()()()}if(t&2){let e=h(2);c(),l("disabled",e.occupationalSkills.length<1)}}function Zt(t,i){t&1&&y(0,"tr",33)}function Xt(t,i){t&1&&y(0,"tr",34)}function Jt(t,i){if(t&1){let e=b();a(0,"div",1)(1,"h1",2),o(2,"Allocate Skill Points"),n(),a(3,"mat-card")(4,"mat-card-content"),r(5,mt,20,4)(6,ut,4,0),n()(),a(7,"mat-card")(8,"mat-card-content")(9,"h2"),o(10,"Occupational Skills"),n(),a(11,"div",3)(12,"table",4),d(13,5),r(14,_t,2,0,"th",6)(15,vt,2,1,"td",7),p(),d(16,8),r(17,gt,2,0,"th",6)(18,ft,2,1,"td",7),p(),d(19,9),r(20,yt,2,0,"th",6)(21,bt,2,1,"td",7),p(),d(22,10),r(23,Ct,2,0,"th",6)(24,xt,2,1,"td",11),p(),d(25,12),r(26,kt,2,0,"th",6)(27,wt,8,2,"td",7),p(),r(28,St,1,0,"tr",13)(29,It,1,0,"tr",14),n()()()(),a(30,"mat-card")(31,"mat-card-content")(32,"h2"),o(33,"Personal Interest Skills"),n(),a(34,"p",15),o(35,"These are skills you've selected to improve based on personal interests."),n(),r(36,Et,3,0,"div",16)(37,jt,22,3,"div",17),n()(),a(38,"mat-card")(39,"mat-card-content")(40,"h2"),o(41,"Other Skills"),n(),a(42,"p",15),o(43,"These skills are not part of your occupation but can be selected as personal interest skills."),n(),a(44,"div",3)(45,"table",4),d(46,5),r(47,Qt,2,0,"th",6)(48,Gt,2,1,"td",7),p(),d(49,8),r(50,qt,2,0,"th",6)(51,Kt,2,1,"td",7),p(),d(52,10),r(53,$t,2,0,"th",6)(54,Wt,2,1,"td",11),p(),d(55,18),r(56,Ut,2,0,"th",6)(57,Yt,4,1,"td",7),p(),r(58,Zt,1,0,"tr",13)(59,Xt,1,0,"tr",14),n()()()(),a(60,"div",19)(61,"button",20),v("click",function(){g(e);let m=h();return f(m.saveAndContinue())}),o(62," Save and Continue "),n()()()}if(t&2){let e=h();c(5),w(e.character.occupation?5:6),c(7),l("dataSource",e.occupationalSkills),c(16),l("matHeaderRowDef",e.occupationalDisplayedColumns),c(),l("matRowDefColumns",e.occupationalDisplayedColumns),c(7),l("ngIf",e.selectedSkills.length===0),c(),l("ngIf",e.selectedSkills.length>0),c(8),l("dataSource",e.otherSkills),c(13),l("matHeaderRowDef",e.otherDisplayedColumns),c(),l("matRowDefColumns",e.otherDisplayedColumns),c(2),l("disabled",!e.canContinue())}}var lt=class t{constructor(i,e,s){this.characterService=i;this.router=e;this.snackBar=s}character;occupationalSkills=[];selectedSkills=[];otherSkills=[];occupationalDisplayedColumns=["name","baseValue","improvementPoints","total","action"];selectedDisplayedColumns=["name","baseValue","improvementPoints","total","action","remove"];otherDisplayedColumns=["name","baseValue","total","add"];ngOnInit(){this.characterService.getCharacter().subscribe(i=>{this.character=i,this.separateSkills()})}separateSkills(){this.occupationalSkills=this.character.skills.filter(i=>i.occupationalSkill&&!i.isSelected).sort((i,e)=>i.name.localeCompare(e.name)),this.selectedSkills=this.character.skills.filter(i=>i.isSelected).sort((i,e)=>i.name.localeCompare(e.name)),this.otherSkills=this.character.skills.filter(i=>!i.occupationalSkill&&!i.isSelected).sort((i,e)=>i.name.localeCompare(e.name))}addToPersonalInterests(i){i.isSelected=!0,this.selectedSkills.push(i),this.selectedSkills.sort((e,s)=>e.name.localeCompare(s.name)),this.otherSkills=this.otherSkills.filter(e=>e.name!==i.name),this.snackBar.open(`Added ${i.name} to your selected skills`,"Close",{duration:2e3})}removeFromPersonalInterests(i){if(i.improvementPoints>0){this.snackBar.open("Cannot remove skill with allocated points","Close",{duration:3e3});return}i.isSelected=!1;let e=[...this.otherSkills];e.push(i),e.sort((s,m)=>s.name.localeCompare(m.name)),this.otherSkills=e,this.selectedSkills=this.selectedSkills.filter(s=>s.name!==i.name),this.snackBar.open(`Removed ${i.name} from your selected skills`,"Close",{duration:2e3})}addPoints(i){this.characterService.allocateSkillPoints(this.character,i,1)||this.snackBar.open("Failed to allocate points. Check your remaining points.","Close",{duration:3e3})}removePoints(i){if(i.improvementPoints<=0){this.snackBar.open("No points to remove","Close",{duration:2e3});return}this.characterService.allocateSkillPoints(this.character,i,-1)||this.snackBar.open("Failed to remove point","Close",{duration:3e3})}canContinue(){return this.occupationalSkills.some(i=>i.improvementPoints>0)||this.selectedSkills.some(i=>i.improvementPoints>0)}saveAndContinue(){this.canContinue()?(this.characterService.saveCharacter(this.character),this.router.navigate(["/backstory"])):this.snackBar.open("You must allocate at least some points to your occupational skills","Close",{duration:3e3})}static \u0275fac=function(e){return new(e||t)(C(R),C(T),C(q))};static \u0275cmp=k({type:t,selectors:[["app-skills-allocator"]],decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"section-title"],[1,"table-container"],["mat-table","",1,"skills-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","baseValue"],["matColumnDef","improvementPoints"],["matColumnDef","total"],["mat-cell","","class","total-column",4,"matCellDef"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"info-text"],["class","empty-state",4,"ngIf"],["class","table-container",4,"ngIf"],["matColumnDef","add"],[1,"actions-container"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"points-remaining"],[1,"skill-instructions"],["class","occupational-skills-description",4,"ngIf"],[1,"occupational-skills-description"],[1,"note"],[1,"no-occupation"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"total-column"],[1,"add-points-container"],["mat-mini-fab","","color","primary",3,"click","disabled"],["mat-mini-fab","","color","warn",3,"click","disabled"],["mat-header-row",""],["mat-row",""],[1,"empty-state"],["matColumnDef","remove"],["mat-icon-button","","color","warn",3,"click","disabled"],["mat-icon-button","","color","primary",3,"click","disabled"]],template:function(e,s){e&1&&r(0,Jt,63,10,"div",0),e&2&&l("ngIf",s.character)},dependencies:[D,A,G,B,F,P,z,L,O,H,ct,Y,X,et,J,Z,at,tt,it,nt,ot,U,$,j,N,rt,Q,K],styles:[".container[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;padding:20px}.points-remaining[_ngcontent-%COMP%]{font-size:1.2em;font-weight:700;color:#512da8}.skill-instructions[_ngcontent-%COMP%]{background-color:#f0f0f0;padding:15px;border-radius:5px;margin-top:15px}.occupational-skills-description[_ngcontent-%COMP%]{margin:20px 0;padding:15px;background-color:#f8f4ff;border-radius:4px;border-left:4px solid #673ab7}.occupational-skills-description[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#673ab7}.occupational-skills-description[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{font-size:.9em;margin-top:15px;color:#666}.table-container[_ngcontent-%COMP%]{overflow-x:auto;margin-top:20px}.skills-table[_ngcontent-%COMP%]{width:100%}.total-column[_ngcontent-%COMP%]{font-weight:700;color:#512da8}.add-points-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.points-input[_ngcontent-%COMP%]{width:70px}button.mat-mini-fab[_ngcontent-%COMP%]{transform:scale(.85)}.info-text[_ngcontent-%COMP%]{color:#666;font-style:italic;margin-bottom:15px}.empty-state[_ngcontent-%COMP%]{padding:20px;text-align:center;background-color:#f8f8f8;border-radius:4px;margin:15px 0;color:#666;font-style:italic}.actions-container[_ngcontent-%COMP%]{margin-top:30px;display:flex;justify-content:flex-end}.no-occupation[_ngcontent-%COMP%]{background-color:#ffeeba;padding:15px;border-radius:5px;margin-top:15px}"]})};export{lt as SkillsAllocatorComponent};
